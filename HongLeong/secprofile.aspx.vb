Imports System.IO
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.OleDb
Imports System.Web
Imports System.Web.UI
Imports System.Web.UI.WebControls
Partial Public Class secpro_class
Inherits detailspage
'Generated by VI SOFTLABS FORM GENERATOR (http://www.vifeandi.net) VER 2014.1
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
listingpage = "secprofilelist.aspx"
_FormsName = "Security Center : User Profile"
TableName = "secuserprofile"
IDPField = ""
IDField = "pf_id"
APPIDField = "pf_appid"
        MerchantIDField = ""
        FilterField = "pf_filter"



        APPCODE = "GENERAL"
        AddRights = "UP1001"
        DelRights = "UP1003"
        ModRights = "UP1002"
        ViewRights = "UP1004"
        FullRights = ""
        NMSpace = "secpro"
Call initLoad()
End Sub
Private Function ValidateForm()
lblmessage.text = ""
If pf_name.text.trim = "" Then
lblmessage.text = "Profile Name is Mandatory"
Return False
Exit Function
End If
If weblib.FilterCode.trim = "" Then
lblmessage.text = "Filter Code is Mandatory"
Return False
Exit Function
End If


Return True
End Function
Public Overrides Function LoadData() As Boolean
Dim cn As New OleDbConnection(connectionstring)
Dim cmd As New OleDbCommand()
Dim ad As New OleDb.OleDbDataAdapter()
Dim ds As New DataSet()
Dim counter As Integer = 0
Dim dr As DataRow
Dim templi As listitem
If isnumeric(rid.value) = False Then
Exit Function
End If

Try 
cmd.CommandText = "Select * from secuserprofile where pf_id=" & rid.value
cmd.Connection = cn
ad.SelectCommand = cmd
ad.Fill(ds, "datarecords")
For Each dr In ds.Tables("datarecords").Rows
counter = counter + 1
pf_name.text = dr("pf_name") & ""
litcreateon.text = dr("pf_createdt") & ""
litcreateby.text = dr("pf_createby") & ""
litupdateon.text = dr("pf_updatedt") & ""
litupdateby.text = dr("pf_updateby") & ""

Exit For
Next
cn.Close()
cmd.Dispose()
cn.Dispose()
Catch ex As Exception
lblmessage.text = ex.Message
 End Try
End Function
Public Sub savepage(ByVal sender As System.Object, ByVal e As System.EventArgs)
Dim insertfields, insertvalues As String
insertfields = ""
insertvalues = ""
If ValidateForm() = False Then
Exit Sub
End If

Try
If rid.value = "" Then
insertfields = insertfields & "pf_name"
insertvalues = insertvalues & "'" & pf_name.text.replace("'", "''") & "'"
insertfields = insertfields & ",pf_createdt"
insertvalues = insertvalues & ",getdate()"
insertfields = insertfields & ",pf_createby"
insertvalues = insertvalues & ",'" & weblib.LoginUser.replace("'", "''") & "'"
insertfields = insertfields & ",pf_updatedt"
insertvalues = insertvalues & ",getdate()"
insertfields = insertfields & ",pf_updateby"
insertvalues = insertvalues & ",'" & weblib.LoginUser.replace("'", "''") & "'"
insertfields = insertfields & ",pf_filter"
insertvalues = insertvalues & ",'" & weblib.FilterCode.replace("'", "''") & "'"
insertfields = insertfields & ",pf_appid"
insertvalues = insertvalues & ",'" & weblib.ApplicationID.replace("'", "''") & "'"
insertfields = insertfields & ",pf_merchantid"
insertvalues = insertvalues & ",'" & weblib.MerchantID.replace("'", "''") & "'"

else
insertvalues = insertvalues & "pf_name='" & pf_name.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",pf_updatedt=getdate()"
insertvalues = insertvalues & ",pf_updateby='" & weblib.LoginUser.replace("'", "''") & "'"

End If

If savedata(insertfields, insertvalues) = True Then
Call gotoback()
End if
Catch Err As Exception
lblmessage.text = Err.message
Finally

End Try
 End Sub
 End Class

