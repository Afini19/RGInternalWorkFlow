Imports System.IO
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.OleDb
Imports System.Web
Imports System.Web.UI
Imports System.Web.UI.WebControls
Partial Public Class wdocs_list_class
    Inherits listpage
    'Generated by VI FEANDI SOFTLABS FORM GENERATOR (http://www.vifeandi.net) VER 2014.1
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        _searchkeystr = ""
        _searchkeystr = "wst_subject;Document Name;S|wst_refno;Ticket No.;S|"

        listingpage = ""
        _FormsName = "Workflow Documents"
        columnscount = "10"
        TableName = "workflowstatus"
        DetailPage = ""
        IDPField = ""
        IDField = "wst_id"
        AppIDField = ""
        MerchantIDField = ""
        FilterField = "wst_filtercode"
        Orderby = ""
        _pagesize = 40
        APPCode = "" '"SMS"
        AddRights = "" '"SM0001"
        DelRights = "" ' "SM0003"
        ModRights = "" '"SM0002"
        ViewRights = "" '"SM0004"
        FullRights = ""
        NmSpace = "worflowdocs"
        pFieldNames = " * "
        pJoinFields = ""

        If Page.IsPostBack = False Then
            bid.value = Request("ba")
        End If


        If (bid.value & "").trim = "" Then
            Response.Redirect("~/home.aspx")
        End If

        _searchfilter = "wst_module='" & bid.value & "'"

        Call InitLoad()

        btnback.visible = False



        Redirector.PrevURL1 = "modules/workflow/wdocs.aspx"
        btnadd.Visible = True

    End Sub
    Protected Sub rep_ItemCommand(ByVal source As Object, ByVal e As System.Web.UI.WebControls.RepeaterCommandEventArgs) Handles rep.ItemCommand


    End Sub
    Protected Sub rep_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rep.ItemDataBound


        Dim drv As DataRowView
        drv = e.Item.DataItem

        Dim objdata As Literal = e.Item.FindControl("litData")
        If Not objdata Is Nothing Then
            Dim llink As String
            Dim lcustomer As String = ""
            If (drv.Row("wst_merchantid") & "").tostring.trim <> "" Then
                lcustomer = "<br></b>Customer ID : <b>" & drv.Row("wst_merchantid").ToString.Trim
            End If
            llink = WebLib.ClientURL(Redirector.Redirect(drv.Row("wst_module").ToString.Trim, drv.Row("wst_ucode").ToString.Trim))
            objdata.Text = "<font class=""cssdetail"">Doc Type :&nbsp;<b>" & drv.Row("wst_subject").ToString.Trim & "</b><br>Ticket No : <b>" & drv.Row("wst_refno").ToString.Trim & "</b>" & lcustomer & "<br>Created By " & drv.Row("wst_createby").ToString.Trim & " " & drv.Row("wst_createon").ToString.Trim & "<br>Status: " & drv.Row("wst_status").ToString.Trim & "</font><br><a href=""" & llink & """>View Document</a>"
        End If


        objdata = e.Item.FindControl("litimage")
        If Not objdata Is Nothing Then
            objdata.Text = "<img src=""" & WebLib.ClientURL("graphics/workflow/paper.png") & """ width=""48"">"
        End If

    End Sub
    Public Sub shortcut1(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Call loaddata(" wst_status='Pending' ")

    End Sub

    Public Sub shortcut2(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Call loaddata(" wst_status='Approved' ")

    End Sub
    Public Sub AddEventAdd(ByVal sender As System.Object, ByVal e As System.EventArgs)

        'server.transfer("~/" & Redirector.Redirect(bid.value, "", True))

        response.redirect("~/" & Redirector.Redirect(bid.value, "", True))


    End Sub
    Public Sub shortcut3(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Call loaddata(" wst_status='Cancelled' ")

    End Sub
    Public Sub shortcut4(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Call loaddata(" wst_status='Rejected' ")

    End Sub

End Class

