Imports System.IO
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.OleDb
Imports System.Web
Imports System.Web.UI
Imports System.Web.UI.WebControls
Partial Public Class secfun_list_class
Inherits listpage
'Generated by VI FEANDI SOFTLABS FORM GENERATOR (http://www.vifeandi.net) VER 2014.1
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
_searchkeystr = "ssf_appid;Application ID;S|ssf_code;Function code;S|ssf_name;Function name;S|"
listingpage = "secfunctionlist.aspx"
_FormsName = "Security Center - Function Code"
columnscount = "12"
TableName = "secfunction"
DetailPage = "secfunction.aspx"
IDPField = ""
IDField = "ssf_id"
APPIDField = ""
MerchantIDField = ""
FilterField = ""
Orderby = ""
_pagesize = 20
APPCODE = "GENERAL"
        AddRights = ""
        DelRights = ""
        ModRights = ""
        ViewRights = ""
FullRights = ""
NMSpace = "secfun"
pFieldNames = "ssf_id,app_name as ssf_appid,ssf_code,ssf_name,ssf_add,ssf_edit,ssf_del,ssf_view,ssf_gotrights,ssf_createby,ssf_updateby"
pJoinFields = " inner join sysApplication on ssf_appid = app_code"
btnback.visible = false
Call initLoad()
End Sub
Protected Sub rep_ItemCommand(ByVal source As Object, ByVal e As System.Web.UI.WebControls.RepeaterCommandEventArgs) Handles rep.ItemCommand
If e.CommandName = "Edit" Then
Response.Redirect("postpage.aspx?NextPage=" & DetailPage & "&ga=" & e.CommandArgument & "&ba=" & bid.value)
End If
If e.CommandName = "Del" Then
Call DeleteRec(e.CommandArgument)
End If
End Sub
Protected Sub rep_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rep.ItemDataBound
Dim objEdit As Object = e.Item.FindControl("lnkEdit")
If Not objEdit Is Nothing Then
If Weblib.hasrights(NmSpace, AppCode, ModRights) = False Then
Try
objEdit.Visible = False
Catch ex As Exception
End Try
End If
End If
Dim objDel As Object = e.Item.FindControl("lnkDelete")
If Not objDel Is Nothing Then
If Weblib.hasrights(NmSpace, AppCode, DelRights) = False Then
Try
objDel.Visible = False
Catch ex As Exception
End Try
End If
End If
End Sub
End Class

