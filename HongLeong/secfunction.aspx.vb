Imports System.IO
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.OleDb
Imports System.Web
Imports System.Web.UI
Imports System.Web.UI.WebControls
Partial Public Class secfun_class
Inherits detailspage
'Generated by VI FEANDI SOFTLABS FORM GENERATOR (http://www.vifeandi.net) VER 2014.1
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
listingpage = "secfunctionlist.aspx"
_FormsName = "Security Center - Function Code"
TableName = "secfunction"
IDPField = ""
IDField = "ssf_id"
APPIDField = ""
MerchantIDField = ""
FilterField = ""
APPCODE = "GENERAL"
        AddRights = ""
        DelRights = ""
        ModRights = ""
        ViewRights = ""
FullRights = ""
NMSpace = "secfun"
If Page.IsPostBack = False Then
Call WebLib.setListItemsTable(ssf_appid, "app_name", "app_code", "sysApplication", "app_name", "", "", "")

End If
Call initLoad()
End Sub
Private Function ValidateForm()
lblmessage.text = ""
If ssf_appid.selectedindex < 0 Then
lblmessage.text = "Application ID is Mandatory"
Return False
Exit Function
End If
If ssf_code.text.trim = "" Then
lblmessage.text = "Function code is Mandatory"
Return False
Exit Function
End If
If ssf_name.text.trim = "" Then
lblmessage.text = "Function name is Mandatory"
Return False
Exit Function
End If

If WebLib.CodeExists(ssf_code.text, "ssf_code", TableName, IDField, rid.value, IDPField, bid.value, AppIDField, MerchantIDField, FilterField) = True Then
lblmessage.text = "This Function code Already Exits"
Return False
Exit Function
End If

Return True
End Function
Public Overrides Function LoadData() As Boolean
Dim cn As New OleDbConnection(connectionstring)
Dim cmd As New OleDbCommand()
Dim ad As New OleDb.OleDbDataAdapter()
Dim ds As New DataSet()
Dim counter As Integer = 0
Dim dr As DataRow
Dim templi As listitem
If isnumeric(rid.value) = False Then
Exit Function
End If

Try 
cmd.CommandText = "Select * from secfunction where ssf_id=" & rid.value
cmd.Connection = cn
ad.SelectCommand = cmd
ad.Fill(ds, "datarecords")
For Each dr In ds.Tables("datarecords").Rows
counter = counter + 1
templi = ssf_appid.Items.FindByValue(dr("ssf_appid") & "")
ssf_appid.SelectedIndex = ssf_appid.Items.IndexOf(templi)
ssf_code.text = dr("ssf_code") & ""
ssf_name.text = dr("ssf_name") & ""
ssf_add.text = dr("ssf_add") & ""
ssf_edit.text = dr("ssf_edit") & ""
ssf_del.text = dr("ssf_del") & ""
ssf_view.text = dr("ssf_view") & ""
ssf_gotrights.text = dr("ssf_gotrights") & ""
litcreateby.text = dr("ssf_createby") & ""
litcreateon.text = dr("ssf_createdt") & ""
litupdateby.text = dr("ssf_updateby") & ""
litupdateon.text = dr("ssf_updatedt") & ""

Exit For
Next
cn.Close()
cmd.Dispose()
cn.Dispose()
Catch ex As Exception
lblmessage.text = ex.Message
 End Try
End Function
Public Sub savepage(ByVal sender As System.Object, ByVal e As System.EventArgs)
Dim insertfields, insertvalues As String
insertfields = ""
insertvalues = ""
If ValidateForm() = False Then
Exit Sub
End If
Dim lssf_appid As String = ""
If ssf_appid.selectedindex < 0 Then
lssf_appid = ""
Else
lssf_appid = ssf_appid.SelectedItem.Value
End If

Try
If rid.value = "" Then
insertfields = insertfields & "ssf_appid"
insertvalues = insertvalues & "'" & lssf_appid & "'"
insertfields = insertfields & ",ssf_code"
insertvalues = insertvalues & ",'" & ssf_code.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_name"
insertvalues = insertvalues & ",'" & ssf_name.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_add"
insertvalues = insertvalues & ",'" & ssf_add.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_edit"
insertvalues = insertvalues & ",'" & ssf_edit.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_del"
insertvalues = insertvalues & ",'" & ssf_del.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_view"
insertvalues = insertvalues & ",'" & ssf_view.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_gotrights"
insertvalues = insertvalues & ",'" & ssf_gotrights.text.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_createby"
insertvalues = insertvalues & ",'" & weblib.LoginUser.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_createdt"
insertvalues = insertvalues & ",getdate()"
insertfields = insertfields & ",ssf_updateby"
insertvalues = insertvalues & ",'" & weblib.LoginUser.replace("'", "''") & "'"
insertfields = insertfields & ",ssf_updatedt"
insertvalues = insertvalues & ",getdate()"

else
insertvalues = insertvalues & "ssf_appid='" & lssf_appid & "'"
insertvalues = insertvalues & ",ssf_code='" & ssf_code.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_name='" & ssf_name.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_add='" & ssf_add.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_edit='" & ssf_edit.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_del='" & ssf_del.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_view='" & ssf_view.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_gotrights='" & ssf_gotrights.text.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_updateby='" & weblib.LoginUser.replace("'", "''") & "'"
insertvalues = insertvalues & ",ssf_updatedt=getdate()"

End If

If savedata(insertfields, insertvalues) = True Then
Call gotoback()
End if
Catch Err As Exception
lblmessage.text = Err.message
Finally

End Try
 End Sub
 End Class

