Imports System.IO
Imports System.Data
Imports System.Data.SqlClient
Imports System.Data.OleDb
Imports System.Web
Imports System.Web.UI
Imports System.Web.UI.WebControls

Partial Public Class modlist_class

    Inherits listpage
    'Generated by VI FEANDI SOFTLABS FORM GENERATOR (http://www.vifeandi.net) VER 2014.1
    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        _searchkeystr = "mod_description;Module Name;S|"""

        listingpage = "catlist.aspx?ga=" & deptid.Value
        _FormsName = "Module Maintenance"
        'columnscount = "10"
        TableName = "module"
        DetailPage = "module.aspx"
        IDPField = ""
        IDField = "mod_id"
        AppIDField = ""
        MerchantIDField = ""
        FilterField = "mod_filter"
        Orderby = ""
        '_pagesize = 40
        APPCode = "" '"SMS"
        AddRights = "" '"SM0001"
        DelRights = "" ' "SM0003"
        ModRights = "" '"SM0002"
        ViewRights = "" '"SM0004"
        FullRights = ""
        NmSpace = "mstrcategory" 'can change
        pFieldNames = " * "
        pJoinFields = ""
        btnback.Visible = True


        If Page.IsPostBack = False Then

            catid.Value = Request("ga") & ""
            deptid.Value = Request("la") & ""
            _searchfilter = "mod_catid = '" & catid.Value & "'"

        Else
            _searchfilter = ""

        End If

        btnback.Visible = True

        Call InitLoad()
    End Sub
    Protected Sub rep_ItemCommand(ByVal source As Object, ByVal e As System.Web.UI.WebControls.RepeaterCommandEventArgs) Handles rep.ItemCommand
        If e.CommandName = "Edit" Then
            Response.Redirect("postpage.aspx?NextPage=" & DetailPage & "&la=" & catid.Value & "&da=" & deptid.Value & "&ga=" & e.CommandArgument & "&ba=" & bid.Value)
        End If
        If e.CommandName = "Delete" Then
            Call DeleteRec(e.CommandArgument)
            Response.Redirect("postpage.aspx?NextPage=" & WebLib.ClientURL("modlist.aspx") & "&ga=" & catid.Value & "&la=" & deptid.Value)
        End If
        'If e.CommandName = "Rights" Then
        '    Response.Redirect("postpage.aspx?NextPage=wgrouprights.aspx&ga=" & e.CommandArgument & "&ba=" & e.CommandArgument)
        'End If

    End Sub
    Protected Sub rep_ItemDataBound(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.RepeaterItemEventArgs) Handles rep.ItemDataBound

        Dim objEdit As Object = e.Item.FindControl("lnkEdit")
        If Not objEdit Is Nothing Then
            If WebLib.hasrights(NmSpace, APPCode, ModRights) = False Then
                Try
                    objEdit.Visible = False
                Catch ex As Exception
                End Try
            End If
        End If

        Dim objDel As Object = e.Item.FindControl("lnkDelete")
        If Not objDel Is Nothing Then
            If WebLib.hasrights(NmSpace, APPCode, DelRights) = False Then
                Try
                    objDel.Visible = False
                Catch ex As Exception
                End Try
            End If
        End If

        Dim drv As DataRowView
        drv = e.Item.DataItem

        Dim objdata As Literal = e.Item.FindControl("litData")
        If Not objdata Is Nothing Then
            objdata.Text = drv.Row("mod_description").ToString.Trim & ""
        End If


        'objdata = e.Item.FindControl("litimage")
        'If Not objdata Is Nothing Then

        '    If drv.Row("wo_active").ToString & "" = "Yes" Then
        '        objdata.Text = "<img src=""" & WebLib.ClientURL("graphics/misc/greenfigure.png") & """ width=""32"">"

        '    Else
        '        objdata.Text = "<img src=""" & WebLib.ClientURL("graphics/misc/redflag.png") & """ width=""32"">"

        '    End If

        'End If

    End Sub

    Public Sub AddEventAdd(ByVal sender As System.Object, ByVal e As System.EventArgs)
        Response.Redirect("postpage.aspx?NextPage=" & WebLib.ClientURL("module.aspx") & "&la=" & catid.Value & "&da=" & deptid.Value)
    End Sub

End Class

